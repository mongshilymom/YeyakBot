<!-- ===== 20분 데모 예약 (Calendly + GA4 이벤트) ===== -->
<section class="container" style="max-width:960px;margin:0 auto;padding:24px;">
  <h1 style="font-size:32px;font-weight:800;margin:8px 0;">20분 데모 예약</h1>
  <p style="color:#6b7280;margin-bottom:16px;">데모 예약 캘린더를 로딩 중입니다…</p>

  <!-- Calendly Inline Embed -->
  <div
    class="calendly-inline-widget"
    data-url="https://calendly.com/yeyakbot/30min?hide_landing_page_details=1&hide_gdpr_banner=1&primary_color=1c64f2"
    style="min-width:320px;height:860px;border:1px solid #eef2f7;border-radius:10px;overflow:hidden;">
  </div>
  <script src="https://assets.calendly.com/assets/external/widget.js" async></script>

  <!-- 보조: 새 창 열기 -->
  <p style="margin-top:10px;color:#6b7280;">
    임베드가 보이지 않으면
    <a href="https://calendly.com/yeyakbot/30min" target="_blank" rel="noopener">여기</a>에서 새 창으로 예약하세요.
  </p>
</section>

<!-- ===== GA4 베이스 (이미 site 전체에 있다면 중복 삽입 금지) ===== -->
<script>
  // TODO: GA4 측정ID로 교체 (예: G-XXXXXXX)
  window.dataLayer = window.dataLayer || [];
  function gtag(){ dataLayer.push(arguments); }
  // gtag('js', new Date()); gtag('config', 'G-XXXXXXXX'); // 이미 전역에서 하고 있으면 생략
</script>

<!-- Calendly → GA4 브리지 -->
<script>
  // Calendly 임베드 이벤트를 GA4로 전달
  // 참조 이벤트: calendly.event_type_viewed, calendly.date_and_time_selected, calendly.event_scheduled
  window.addEventListener('message', function(e) {
    // 안전: 메시지 출처 확인
    if (!e.origin || !e.origin.includes('calendly.com')) return;
    if (!e.data || typeof e.data !== 'object') return;

    var payload = e.data;
    if (payload.event && payload.event.indexOf('calendly.') === 0) {
      // 공통 파라미터
      var base = {
        page_section: 'demo',       // 어떤 페이지/섹션인지 구분
        calendly_event: payload.event
      };

      // 이벤트 매핑
      switch (payload.event) {
        case 'calendly.event_type_viewed':
          gtag('event', 'calendly_type_viewed', base);
          break;
        case 'calendly.date_and_time_selected':
          gtag('event', 'calendly_time_selected', base);
          break;
        case 'calendly.event_scheduled':
          // 최종 전환(예약 완료)으로 잡기
          gtag('event', 'schedule', Object.assign({}, base, { method: 'calendly' }));
          // 필요 시 추가: gtag('event', 'generate_lead', {...});
          break;
      }
    }
  }, false);
</script>
<!-- =============================================== -->
