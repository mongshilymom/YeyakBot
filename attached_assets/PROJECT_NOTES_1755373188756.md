# YEYAKBOT — 정밀 운영 요약(런북)

## Config

# 24/7 접수는 봇이, 데모 미팅은 사람 시간만 제한
runtime_policy:
  intake_24_7: true
  auto_reply: true
  human_demo:
    mode: "office_hours"              # office_hours | extended | full_24_7
    min_notice_hours: 2
    buffer_min: { before: 10, after: 10 }

# 데모용 캘린들리(사람이 만나는 시간창)
calendly_demo_event:
  url: "**https://calendly.com/yeyakbot/20min-demo**"          # 예: https://calendly.com/username/20min-demo
  timezone: "Asia/Seoul"
  duration_min: 20
  weekly_hours:
    - day: Mon; ranges: ["09:00-17:00"]
    - day: Tue; ranges: ["09:00-17:00"]
    - day: Wed; ranges: ["09:00-17:00"]
    - day: Thu; ranges: ["09:00-17:00"]
    - day: Fri; ranges: ["09:00-17:00"]

# 3분 예약 폼(지금 쓰는 구글 폼)
booking_form:
  view_url: "https://docs.google.com/forms/d/e/1FAIpQLSdkcrGra4PgZzIuPPbc12Hr8vu_xwZusMO8aFTDwOjSARn1lg/viewform"
  response_sheet: "**예약봇_리드시트**"     # 실제 시트 이름
  fields: { name: "이름", phone: "연락처", email: "이메일",
            service: "서비스", date: "희망일시", time: "시간", memo: "추가 메모" }
  apps_script: { trigger: "onFormSubmit@Head", actions: ["접수 확인 메일"] }

# Cloudflare 리디렉트/캐시(지금 설정과 동일)
cloudflare:
  redirects:
    - { name: "booking", from: "/booking|/booking/", to: "https://yeyakbot.com/booking.html", code: 301 }
    - { name: "demo",    from: "/demo|/demo/",       to: "https://yeyakbot.com/demo.html",    code: 301 }
  cache: { html_ttl: "5m", assets_ttl: "1y" }

# GA4 (모르면 일단 TODO)
analytics:
  ga4_measurement_id: "**G-XXXXXXX**"  # 예: G-ABC123DEF
  events: ["lead_submit", "schedule_demo_view", "schedule_demo_click"]


## Backlog (from Brainbooster)
- Cloudflare 캐시: /assets 1년, *.html 5분
- 리디렉트: /booking→/booking.html, /demo→/demo.html
- booking.html / demo.html 실제 Form & Calendly URL 교체
- 이메일 전달성: DKIM 키 발급, DMARC 정책 설정 및 수신/발신 테스트
- 채널 연결: GA4, GSC, 네이버 서치어드바이저, 카카오 채널

> 마지막 업데이트: (작성일 갱신)

## 0) 한 줄 현황
- **메인 도메인** `yeyakbot.com` → Cloudflare 연결 ✅ / Replit 배포 ✅ / Google Workspace 메일 수신 ✅
- **서브 페이지** `/booking.html`, `/demo.html` 구성 ✅ (실제 폼/캘린더 URL은 교체 대기)
- **이메일**: founder(슈퍼관리자) 활성 + 주요 별칭(hello/sales/support/billing/privacy) 수신 준비 완료
- **보강 예정**: Cloudflare 캐시 규칙, GA4/네이버/카카오, DKIM/DMARC, `/booking`·`/demo` 짧은 경로

---

## 1) 도메인/소유 현황
### 확정 보유(확인됨)
- `yeyakbot.com`  ← **메인**
- `yeyakbot.kr`, `yeyakbot.co.kr` ← **브랜드 보호(디펜시브)**  
- `예약봇.kr`, `24bot.kr`, `예약봇.com` (스크린샷 기준 보유 확인) ← **보호/마케팅용(현재 미연결)**

### 미보유/대기
- `예약봇.co.kr` (구매 불가로 확인)  
- `yeyak.app` (검토만, 미구매)

> 디펜시브 도메인은 **Cloudflare로만 위임**해 두고, DNS는 비워둬도 OK. 추후 리디렉션/랜딩에 활용.

---

## 2) Cloudflare (yeyakbot.com Zone)
### 네임서버
- `kyree.ns.cloudflare.com`, `suzanne.ns.cloudflare.com` (가비아에 적용 완료)

### 현재 DNS 스냅샷 (2025-08-17)
- `A @` → `34.111.179.208` (**Proxy ON**)
- `CNAME www` → `yeyakbot.replit.app` (**Proxy ON** / 권장)
  ※ 문서 v0.1에 "www Proxy OFF"로 되어 있는데, Redirect Rules 사용을 위해 **ON으로 운영**.
- **MX (Google Workspace)**
  - `aspmx.l.google.com` (prio 1)
  - `alt1.aspmx.l.google.com` (5)
  - `alt2.aspmx.l.google.com` (5)
  - `alt3.aspmx.l.google.com` (10)
  - `alt4.aspmx.l.google.com` (10)
- **TXT**
  - `v=spf1 include:_spf.google.com ~all`
  - `google-site-verification=...`
  - `replit-verify=...`

### (권장) 캐시/규칙
1) **/assets/** → Cache Everything (Edge/Browser TTL **1년**)  
2) **/** 및 `*.html` → Cache Everything (TTL **5분**)  
3) (옵션) `/booking.html`, `/demo.html` → **Bypass cache**  
4) (필요시) `www → 루트` 리다이렉트 규칙(현재는 CNAME으로 충분)

> 규칙은 **Rules → Page Rules 또는 Rules → Custom Rules**에서 추가. 순서 상단일수록 우선.

---

## 3) Replit 배포
- 프로젝트 배포 ✅
- 연결 도메인:  
  - `yeyakbot.com` — **Verified**  
  - `www.yeyakbot.com` — **Verified**
- 정적 파일 페이지:  
  - `index.html` → 랜딩  
  - `booking.html` → **3분 예약** (Google Forms 임베드 자리)  
  - `demo.html` → **20분 데모** (Calendly 임베드 자리)

### 짧은 경로(권장)
- `/booking` → `/booking.html`  
- `/demo` → `/demo.html`  
  - 구현 방식(둘 중 택1):  
    a) `/booking/index.html`, `/demo/index.html`에 **meta refresh**  
    ```html
    <!-- /booking/index.html -->
    <meta http-equiv="refresh" content="0; url=/booking.html" />
    ```  
    b) Cloudflare Redirect Rule로 `/booking` → `/booking.html` 301

### 404 관련 메모
- 과거 `/booking.html` 직접 접속 404는 **Replit 정적 경로/임베드 준비 전 상태**에서 발생.  
- 현재는 페이지 파일 존재 → 정상 로드(폼/캘린더 URL만 교체 필요).  
- “로딩중…”만 보이면 임베드 URL 미삽입이 원인.

---

## 4) 페이지 내 교체 포인트 (아직 미입력)
- `booking.html` → `REPLACE_FORM_URL` 를 **실제 Google Form**으로 교체  
- `demo.html` → `REPLACE_CALENDLY_URL` 를 **실제 Calendly**로 교체

---

## 5) Google Workspace
- **도메인**: yeyakbot.com (검증 완료)  
- **슈퍼관리자(Founder)**: `founder@yeyakbot.com`  
- **별칭(aliases)**:  
  - `hello@` (대외 기본)  
  - `sales@` (견적/도입문의)  
  - `support@` (기술/고객지원)  
  - `billing@` (정산/세금계산서)  
  - `privacy@` (개인정보 문의)  
- **postmaster@ / abuse@**: 그룹 미생성. 현재는 Google이 자동으로 **슈퍼관리자에게 전달**됨(기본행동).  
  - 운영 중 수신량 많아지면 **그룹 + 공유메일함** 전환 권장.

### 메일 보안/전달성 — 할 일
- [ ] **DKIM**: Admin Console → 앱 → Google Workspace → Gmail → **DKIM** → **키 생성** 후, **CNAME 레코드**를 Cloudflare에 추가 → 활성화  
- [ ] **DMARC**(권장): TXT 레코드 `_dmarc.yeyakbot.com`  





v=DMARC1; p=quarantine; rua=mailto:postmaster@yeyakbot.com; fo=1;

(운영 초반엔 `p=none`로 모니터링부터 시작 가능)

---

## 6) SEO/분석/채널 — 할 일
- [ ] **GA4 ID** 삽입 (헤드에 gtag 또는 GTM)  
- [ ] **네이버 사이트 소유 인증**(Search Advisor) — 메타태그/TXT 중 선택  
- [ ] **카카오 채널** URL/버튼 연결  
- [ ] **대표 전화번호** 표기/연동  
- [ ] 파비콘/OG 이미지 최종 반영 확인 (`/assets/favicon-32.png`, `/assets/favicon-192.png`, `og.png`)  
- [ ] Cloudflare Analytics/Cache 상태 점검

---

## 7) 점검 체크리스트 (릴리즈 전/후)
- [ ] `https://yeyakbot.com/` 랜딩 노출  
- [ ] `https://yeyakbot.com/booking` → `/booking.html` 도달  
- [ ] `https://yeyakbot.com/demo`    → `/demo.html` 도달  
- [ ] booking 폼 제출 테스트(수신/알림)  
- [ ] demo 캘린더 예약 버튼/슬롯 정상  
- [ ] hello@sales@support@ 메일 **외부 수신/내부 발신** 테스트  
- [ ] SPF/DKIM/DMARC 검사(pass) — Gmail 메시지 원본에서 확인  
- [ ] Cloudflare Cache 동작 확인(특히 /assets/*)

---

## 8) 운영/유지보수 요령
- 작은 텍스트/가격 수정 → `index.html`만 변경 후 재배포  
- 정책/약관/푸터 메일 주소 변경 → `footer` 포함 공통 섹션 동시 반영  
- **변경 시마다** 이 `PROJECT_NOTES.md`의 **변경 로그** 업데이트

---

## 9) 자주 겪는 이슈 & 빠른 해결
- **www만 열리고 루트가 안 열림**: `A @` 레코드/프록시 상태 확인  
- **폼/캘린더 안 보임**: 임베드 URL 또는 X-Frame-Options 차단 여부 확인  
- **메일 스팸 처리**: DKIM/DMARC 미설정이 흔한 원인 → 즉시 설정  
- **리소스 느림**: `/assets/*` 캐시 규칙 적용/확인

---

## 10) 변경 로그
- 2025-08-16:  
- Cloudflare로 `yeyakbot.com` 이관 + DNS/NS 정리  
- Replit 배포 & 도메인 검증 (`@`, `www`)  
- Workspace 초기화(Founder 생성, 별칭 다섯 종)  
- `/booking.html`, `/demo.html` 배치(실 URL 미삽입 상태)
- (여기에 앞으로 변경 시마다 한 줄씩 추가)
- 2025-08-17: Cloudflare 캐시 초기화 완료 / 스모크 OK
- 2025-08-17: Google Forms 실제 URL 연동 완료 (booking.html, booking-lite.html)
- 2025-08-17: booking-iframe.html 생성 완료 (Google Forms iframe 임베드 방식)
- 2025-08-17: GA4 스니펫 표준화 완료 (모든 8개 페이지 통일)
- 2025-08-17: GA4 이벤트 추적 표준화 완료 (place, variant 파라미터 전체 적용)
- 2025-08-17: Google Apps Script 통합 가이드 작성 완료 (이메일/백엔드/GA4/Slack)
- 2025-08-17: booking-iframe.html 최적화 (로딩 상태, z-index 개선)
- 2025-08-17: GA4 이벤트 추적 완료 (privacy.html, terms.html 포함 전체 8페이지)
- 2025-08-17: booking.html 간편화 완료 (Google Forms 버튼 방식 적용)
- 2025-08-17: booking.html 완전 재작성 (초경량 최적화 버전)
- 2025-08-17: index.html 메인 페이지 완전 최적화 (Hero+Deposit+FAQ 통합)
- 2025-08-17: Config YAML 추가 완료 (v1-min 운영 설정)

## Changelog
[2025-08-21]
- 변경: Google Apps Script GA4 Measurement Protocol 통합 완료
- 이유: 서버사이드 실제 제출 추적으로 정확한 전환 측정
- 영향: 클라이언트+서버 양방향 GA4 추적, 데이터 정확도 향상
- 다음: GA4에서 lead_submit 이벤트 검증, Measurement Protocol API Secret 설정

[2025-08-21]
- 변경: 홈 히어로/보증금/FAQ 섹션 추가, demo.html 캘린들리 임베드 교체
- 이유: 전환 설명 강화 및 404 제거
- 영향: 데모/리드 퍼널 연결, 계측(뷰/클릭) 시작
- 다음: P2 값 채우기(캘린들리 URL/시트명/GA4 ID) 후 캐시 퍼지·스모크 2건

[2025-08-18]
- 변경: Google Form 임베드 연결, Apps Script onFormSubmit 트리거 설정
- 이유: 리드 자동접수/자동메일 시작
- 영향: 폼→메일→시트 E2E 동작
- 다음: GA4 이벤트·보증금 링크 연동

[2025-08-18]
- 변경: Config 섹션 최초 생성(v1-min), Calendly/폼/Cloudflare/GA4 자리 지정
- 이유: 운영 설정 단일 소스 구축
- 영향: 설정·복구·이관 속도 ↑
- 다음: GA4 ID 기입, Calendly 링크 확정 후 demo.html 교체 확인
- 2025-08-21: demo.html Calendly 인라인 임베드 완료 (yeyakbot/20min-demo)
- 2025-08-21: booking.html GA4 lead_submit 이벤트 추가 완료
- 2025-08-21: demo.html Calendly URL 업데이트 완료 (30min 이벤트)
- 2025-08-21: demo.html Calendly 팝업 위젯 옵션 추가 완료
- 2025-08-21: demo.html을 20분 데모로 정리 완료 (streamlined template)
- 2025-08-21: demo.html Calendly URL 수정 완료 (30min 이벤트, 올바른 형식)
- 2025-08-21: demo.html iframe 임베드로 전환 완료 (안정성 개선)
- 2025-08-21: demo.html 완전 간소화 (inline style, widget 복원)
- 2025-08-21: demo.html 고급 GA4 이벤트 추적 시스템 구현 완료
- 2025-08-21: booking.html GA4 추적 개선 (page_location 파라미터 추가)
- 2025-08-21: demo.html 페이지 뷰 추적 중복 방지 로직 추가
- 2025-08-21: 전체 사이트 GA4 스크립트 표준 포맷으로 통일
- 2025-08-21: demo.html GA4 스크립트 코드 스타일 개선 (가독성 향상)
- 2025-08-21: Google Apps Script GA4 Measurement Protocol 통합 완료
- 2025-08-22: 헤더 구조 간소화 (site-header 클래스, 로고 이미지 제거)
- 2025-08-22: site-header CSS 최적화 (간소화된 스타일링)
